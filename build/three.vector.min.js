// threejs.org/license
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self).THREE_VEC={})}(this,(function(t){"use strict";for(var i=[],e=0;e<256;e++)i[e]=(e<16?"0":"")+e.toString(16);var r=1234567,n={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(i[255&t]+i[t>>8&255]+i[t>>16&255]+i[t>>24&255]+"-"+i[255&e]+i[e>>8&255]+"-"+i[e>>16&15|64]+i[e>>24&255]+"-"+i[63&r|128]+i[r>>8&255]+"-"+i[r>>16&255]+i[r>>24&255]+i[255&n]+i[n>>8&255]+i[n>>16&255]+i[n>>24&255]).toUpperCase()},clamp:function(t,i,e){return Math.max(i,Math.min(e,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,e,r,n){return r+(t-i)*(n-r)/(e-i)},lerp:function(t,i,e){return(1-e)*t+e*i},smoothstep:function(t,i,e){return t<=i?0:t>=e?1:(t=(t-i)/(e-i))*t*(3-2*t)},smootherstep:function(t,i,e){return t<=i?0:t>=e?1:(t=(t-i)/(e-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(r=t%2147483647),((r=16807*r%2147483647)-1)/2147483646},degToRad:function(t){return t*n.DEG2RAD},radToDeg:function(t){return t*n.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,i,e,r,n){var s=Math.cos,o=Math.sin,h=s(e/2),a=o(e/2),u=s((i+r)/2),c=o((i+r)/2),l=s((i-r)/2),y=o((i-r)/2),p=s((r-i)/2),f=o((r-i)/2);switch(n){case"XYX":t.set(h*c,a*l,a*y,h*u);break;case"YZY":t.set(a*y,h*c,a*l,h*u);break;case"ZXZ":t.set(a*l,a*y,h*c,h*u);break;case"XZX":t.set(h*c,a*f,a*p,h*u);break;case"YXY":t.set(a*p,h*c,a*f,h*u);break;case"ZYZ":t.set(a*f,a*p,h*c,h*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}},s=function(){function t(t,i,e){return void 0===t&&(t=1),void 0===i&&(i=0),void 0===e&&(e=0),this.radius=t,this.phi=i,this.theta=e,this}var i=t.prototype;return i.set=function(t,i,e){return this.radius=t,this.phi=i,this.theta=e,this},i.clone=function(){return(new this.constructor).copy(this)},i.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},i.makeSafe=function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},i.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},i.setFromCartesianCoords=function(t,i,e){return this.radius=Math.sqrt(t*t+i*i+e*e),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,e),this.phi=Math.acos(n.clamp(i/this.radius,-1,1))),this},t}(),o=function(){function t(t,i,e){return this.radius=void 0!==t?t:1,this.theta=void 0!==i?i:0,this.y=void 0!==e?e:0,this}var i=t.prototype;return i.set=function(t,i,e){return this.radius=t,this.theta=i,this.y=e,this},i.clone=function(){return(new this.constructor).copy(this)},i.copy=function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},i.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},i.setFromCartesianCoords=function(t,i,e){return this.radius=Math.sqrt(t*t+e*e),this.theta=Math.atan2(t,e),this.y=i,this},t}();function h(t,i){for(var e=0;e<i.length;e++){var r=i[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,i,e){return i&&h(t.prototype,i),e&&h(t,e),t}var u=function(){function t(t,i,e,r){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===r&&(r=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=i,this._z=e,this._w=r}t.slerp=function(t,i,e,r){return e.copy(t).slerp(i,r)},t.slerpFlat=function(t,i,e,r,n,s,o){var h=e[r+0],a=e[r+1],u=e[r+2],c=e[r+3],l=n[s+0],y=n[s+1],p=n[s+2],f=n[s+3];if(c!==f||h!==l||a!==y||u!==p){var v=1-o,x=h*l+a*y+u*p+c*f,m=x>=0?1:-1,d=1-x*x;if(d>Number.EPSILON){var g=Math.sqrt(d),_=Math.atan2(g,x*m);v=Math.sin(v*_)/g,o=Math.sin(o*_)/g}var M=o*m;if(h=h*v+l*M,a=a*v+y*M,u=u*v+p*M,c=c*v+f*M,v===1-o){var b=1/Math.sqrt(h*h+a*a+u*u+c*c);h*=b,a*=b,u*=b,c*=b}}t[i]=h,t[i+1]=a,t[i+2]=u,t[i+3]=c},t.multiplyQuaternionsFlat=function(t,i,e,r,n,s){var o=e[r],h=e[r+1],a=e[r+2],u=e[r+3],c=n[s],l=n[s+1],y=n[s+2],p=n[s+3];return t[i]=o*p+u*c+h*y-a*l,t[i+1]=h*p+u*l+a*c-o*y,t[i+2]=a*p+u*y+o*l-h*c,t[i+3]=u*p-o*c-h*l-a*y,t};var i=t.prototype;return i.set=function(t,i,e,r){return this._x=t,this._y=i,this._z=e,this._w=r,this._onChangeCallback(),this},i.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},i.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},i.setFromEuler=function(t,i){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var e=t._x,r=t._y,n=t._z,s=t._order,o=Math.cos,h=Math.sin,a=o(e/2),u=o(r/2),c=o(n/2),l=h(e/2),y=h(r/2),p=h(n/2);switch(s){case"XYZ":this._x=l*u*c+a*y*p,this._y=a*y*c-l*u*p,this._z=a*u*p+l*y*c,this._w=a*u*c-l*y*p;break;case"YXZ":this._x=l*u*c+a*y*p,this._y=a*y*c-l*u*p,this._z=a*u*p-l*y*c,this._w=a*u*c+l*y*p;break;case"ZXY":this._x=l*u*c-a*y*p,this._y=a*y*c+l*u*p,this._z=a*u*p+l*y*c,this._w=a*u*c-l*y*p;break;case"ZYX":this._x=l*u*c-a*y*p,this._y=a*y*c+l*u*p,this._z=a*u*p-l*y*c,this._w=a*u*c+l*y*p;break;case"YZX":this._x=l*u*c+a*y*p,this._y=a*y*c+l*u*p,this._z=a*u*p-l*y*c,this._w=a*u*c-l*y*p;break;case"XZY":this._x=l*u*c-a*y*p,this._y=a*y*c-l*u*p,this._z=a*u*p+l*y*c,this._w=a*u*c+l*y*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==i&&this._onChangeCallback(),this},i.setFromAxisAngle=function(t,i){var e=i/2,r=Math.sin(e);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(e),this._onChangeCallback(),this},i.setFromRotationMatrix=function(t){var i=t.elements,e=i[0],r=i[4],n=i[8],s=i[1],o=i[5],h=i[9],a=i[2],u=i[6],c=i[10],l=e+o+c;if(l>0){var y=.5/Math.sqrt(l+1);this._w=.25/y,this._x=(u-h)*y,this._y=(n-a)*y,this._z=(s-r)*y}else if(e>o&&e>c){var p=2*Math.sqrt(1+e-o-c);this._w=(u-h)/p,this._x=.25*p,this._y=(r+s)/p,this._z=(n+a)/p}else if(o>c){var f=2*Math.sqrt(1+o-e-c);this._w=(n-a)/f,this._x=(r+s)/f,this._y=.25*f,this._z=(h+u)/f}else{var v=2*Math.sqrt(1+c-e-o);this._w=(s-r)/v,this._x=(n+a)/v,this._y=(h+u)/v,this._z=.25*v}return this._onChangeCallback(),this},i.setFromUnitVectors=function(t,i){var e=t.dot(i)+1;return e<1e-6?(e=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=e):(this._x=0,this._y=-t.z,this._z=t.y,this._w=e)):(this._x=t.y*i.z-t.z*i.y,this._y=t.z*i.x-t.x*i.z,this._z=t.x*i.y-t.y*i.x,this._w=e),this.normalize()},i.angleTo=function(t){return 2*Math.acos(Math.abs(n.clamp(this.dot(t),-1,1)))},i.rotateTowards=function(t,i){var e=this.angleTo(t);if(0===e)return this;var r=Math.min(1,i/e);return this.slerp(t,r),this},i.identity=function(){return this.set(0,0,0,1)},i.inverse=function(){return this.conjugate()},i.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},i.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},i.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},i.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},i.normalize=function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},i.multiply=function(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)},i.premultiply=function(t){return this.multiplyQuaternions(t,this)},i.multiplyQuaternions=function(t,i){var e=t._x,r=t._y,n=t._z,s=t._w,o=i._x,h=i._y,a=i._z,u=i._w;return this._x=e*u+s*o+r*a-n*h,this._y=r*u+s*h+n*o-e*a,this._z=n*u+s*a+e*h-r*o,this._w=s*u-e*o-r*h-n*a,this._onChangeCallback(),this},i.slerp=function(t,i){if(0===i)return this;if(1===i)return this.copy(t);var e=this._x,r=this._y,n=this._z,s=this._w,o=s*t._w+e*t._x+r*t._y+n*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=e,this._y=r,this._z=n,this;var h=1-o*o;if(h<=Number.EPSILON){var a=1-i;return this._w=a*s+i*this._w,this._x=a*e+i*this._x,this._y=a*r+i*this._y,this._z=a*n+i*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(h),c=Math.atan2(u,o),l=Math.sin((1-i)*c)/u,y=Math.sin(i*c)/u;return this._w=s*l+this._w*y,this._x=e*l+this._x*y,this._y=r*l+this._y*y,this._z=n*l+this._z*y,this._onChangeCallback(),this},i.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},i.fromArray=function(t,i){return void 0===i&&(i=0),this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this._onChangeCallback(),this},i.toArray=function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t},i.fromBufferAttribute=function(t,i){return this._x=t.getX(i),this._y=t.getY(i),this._z=t.getZ(i),this._w=t.getW(i),this},i._onChange=function(t){return this._onChangeCallback=t,this},i._onChangeCallback=function(){},a(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}]),t}(),c=function(){function t(t,i,e){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=i,this.z=e}var i=t.prototype;return i.set=function(t,i,e){return void 0===e&&(e=this.z),this.x=t,this.y=i,this.z=e,this},i.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this},i.setX=function(t){return this.x=t,this},i.setY=function(t){return this.y=t,this},i.setZ=function(t){return this.z=t,this},i.setComponent=function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this},i.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},i.clone=function(){return new this.constructor(this.x,this.y,this.z)},i.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},i.add=function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},i.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},i.addVectors=function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},i.addScaledVector=function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},i.sub=function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},i.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},i.subVectors=function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},i.multiply=function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},i.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},i.multiplyVectors=function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},i.applyEuler=function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(y.setFromEuler(t))},i.applyAxisAngle=function(t,i){return this.applyQuaternion(y.setFromAxisAngle(t,i))},i.applyMatrix3=function(t){var i=this.x,e=this.y,r=this.z,n=t.elements;return this.x=n[0]*i+n[3]*e+n[6]*r,this.y=n[1]*i+n[4]*e+n[7]*r,this.z=n[2]*i+n[5]*e+n[8]*r,this},i.applyNormalMatrix=function(t){return this.applyMatrix3(t).normalize()},i.applyMatrix4=function(t){var i=this.x,e=this.y,r=this.z,n=t.elements,s=1/(n[3]*i+n[7]*e+n[11]*r+n[15]);return this.x=(n[0]*i+n[4]*e+n[8]*r+n[12])*s,this.y=(n[1]*i+n[5]*e+n[9]*r+n[13])*s,this.z=(n[2]*i+n[6]*e+n[10]*r+n[14])*s,this},i.applyQuaternion=function(t){var i=this.x,e=this.y,r=this.z,n=t.x,s=t.y,o=t.z,h=t.w,a=h*i+s*r-o*e,u=h*e+o*i-n*r,c=h*r+n*e-s*i,l=-n*i-s*e-o*r;return this.x=a*h+l*-n+u*-o-c*-s,this.y=u*h+l*-s+c*-n-a*-o,this.z=c*h+l*-o+a*-s-u*-n,this},i.project=function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},i.unproject=function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},i.transformDirection=function(t){var i=this.x,e=this.y,r=this.z,n=t.elements;return this.x=n[0]*i+n[4]*e+n[8]*r,this.y=n[1]*i+n[5]*e+n[9]*r,this.z=n[2]*i+n[6]*e+n[10]*r,this.normalize()},i.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},i.divideScalar=function(t){return this.multiplyScalar(1/t)},i.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},i.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},i.clamp=function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this},i.clampScalar=function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this},i.clampLength=function(t,i){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(i,e)))},i.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},i.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},i.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},i.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},i.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},i.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},i.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},i.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},i.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},i.normalize=function(){return this.divideScalar(this.length()||1)},i.setLength=function(t){return this.normalize().multiplyScalar(t)},i.lerp=function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},i.lerpVectors=function(t,i,e){return this.x=t.x+(i.x-t.x)*e,this.y=t.y+(i.y-t.y)*e,this.z=t.z+(i.z-t.z)*e,this},i.cross=function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i)):this.crossVectors(this,t)},i.crossVectors=function(t,i){var e=t.x,r=t.y,n=t.z,s=i.x,o=i.y,h=i.z;return this.x=r*h-n*o,this.y=n*s-e*h,this.z=e*o-r*s,this},i.projectOnVector=function(t){var i=t.lengthSq();if(0===i)return this.set(0,0,0);var e=t.dot(this)/i;return this.copy(t).multiplyScalar(e)},i.projectOnPlane=function(t){return l.copy(this).projectOnVector(t),this.sub(l)},i.reflect=function(t){return this.sub(l.copy(t).multiplyScalar(2*this.dot(t)))},i.angleTo=function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===i)return Math.PI/2;var e=this.dot(t)/i;return Math.acos(n.clamp(e,-1,1))},i.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},i.distanceToSquared=function(t){var i=this.x-t.x,e=this.y-t.y,r=this.z-t.z;return i*i+e*e+r*r},i.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},i.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},i.setFromSphericalCoords=function(t,i,e){var r=Math.sin(i)*t;return this.x=r*Math.sin(e),this.y=Math.cos(i)*t,this.z=r*Math.cos(e),this},i.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},i.setFromCylindricalCoords=function(t,i,e){return this.x=t*Math.sin(i),this.y=e,this.z=t*Math.cos(i),this},i.setFromMatrixPosition=function(t){var i=t.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this},i.setFromMatrixScale=function(t){var i=this.setFromMatrixColumn(t,0).length(),e=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=e,this.z=r,this},i.setFromMatrixColumn=function(t,i){return this.fromArray(t.elements,4*i)},i.setFromMatrix3Column=function(t,i){return this.fromArray(t.elements,3*i)},i.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},i.fromArray=function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this},i.toArray=function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t},i.fromBufferAttribute=function(t,i,e){return void 0!==e&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this},i.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},t}(),l=new c,y=new u,p=function(){function t(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var i=t.prototype;return i.set=function(t,i,e,r,n,s,o,h,a,u,c,l,y,p,f,v){var x=this.elements;return x[0]=t,x[4]=i,x[8]=e,x[12]=r,x[1]=n,x[5]=s,x[9]=o,x[13]=h,x[2]=a,x[6]=u,x[10]=c,x[14]=l,x[3]=y,x[7]=p,x[11]=f,x[15]=v,this},i.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},i.clone=function(){return(new t).fromArray(this.elements)},i.copy=function(t){var i=this.elements,e=t.elements;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],this},i.copyPosition=function(t){var i=this.elements,e=t.elements;return i[12]=e[12],i[13]=e[13],i[14]=e[14],this},i.extractBasis=function(t,i,e){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),e.setFromMatrixColumn(this,2),this},i.makeBasis=function(t,i,e){return this.set(t.x,i.x,e.x,0,t.y,i.y,e.y,0,t.z,i.z,e.z,0,0,0,0,1),this},i.extractRotation=function(t){var i=this.elements,e=t.elements,r=1/f.setFromMatrixColumn(t,0).length(),n=1/f.setFromMatrixColumn(t,1).length(),s=1/f.setFromMatrixColumn(t,2).length();return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=0,i[4]=e[4]*n,i[5]=e[5]*n,i[6]=e[6]*n,i[7]=0,i[8]=e[8]*s,i[9]=e[9]*s,i[10]=e[10]*s,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},i.makeRotationFromEuler=function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=this.elements,e=t.x,r=t.y,n=t.z,s=Math.cos(e),o=Math.sin(e),h=Math.cos(r),a=Math.sin(r),u=Math.cos(n),c=Math.sin(n);if("XYZ"===t.order){var l=s*u,y=s*c,p=o*u,f=o*c;i[0]=h*u,i[4]=-h*c,i[8]=a,i[1]=y+p*a,i[5]=l-f*a,i[9]=-o*h,i[2]=f-l*a,i[6]=p+y*a,i[10]=s*h}else if("YXZ"===t.order){var v=h*u,x=h*c,m=a*u,d=a*c;i[0]=v+d*o,i[4]=m*o-x,i[8]=s*a,i[1]=s*c,i[5]=s*u,i[9]=-o,i[2]=x*o-m,i[6]=d+v*o,i[10]=s*h}else if("ZXY"===t.order){var g=h*u,_=h*c,M=a*u,b=a*c;i[0]=g-b*o,i[4]=-s*c,i[8]=M+_*o,i[1]=_+M*o,i[5]=s*u,i[9]=b-g*o,i[2]=-s*a,i[6]=o,i[10]=s*h}else if("ZYX"===t.order){var z=s*u,w=s*c,C=o*u,S=o*c;i[0]=h*u,i[4]=C*a-w,i[8]=z*a+S,i[1]=h*c,i[5]=S*a+z,i[9]=w*a-C,i[2]=-a,i[6]=o*h,i[10]=s*h}else if("YZX"===t.order){var k=s*h,A=s*a,P=o*h,T=o*a;i[0]=h*u,i[4]=T-k*c,i[8]=P*c+A,i[1]=c,i[5]=s*u,i[9]=-o*u,i[2]=-a*u,i[6]=A*c+P,i[10]=k-T*c}else if("XZY"===t.order){var E=s*h,O=s*a,R=o*h,L=o*a;i[0]=h*u,i[4]=-c,i[8]=a*u,i[1]=E*c+L,i[5]=s*u,i[9]=O*c-R,i[2]=R*c-O,i[6]=o*u,i[10]=L*c+E}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},i.makeRotationFromQuaternion=function(t){return this.compose(x,t,m)},i.lookAt=function(t,i,e){var r=this.elements;return _.subVectors(t,i),0===_.lengthSq()&&(_.z=1),_.normalize(),d.crossVectors(e,_),0===d.lengthSq()&&(1===Math.abs(e.z)?_.x+=1e-4:_.z+=1e-4,_.normalize(),d.crossVectors(e,_)),d.normalize(),g.crossVectors(_,d),r[0]=d.x,r[4]=g.x,r[8]=_.x,r[1]=d.y,r[5]=g.y,r[9]=_.y,r[2]=d.z,r[6]=g.z,r[10]=_.z,this},i.multiply=function(t,i){return void 0!==i?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,i)):this.multiplyMatrices(this,t)},i.premultiply=function(t){return this.multiplyMatrices(t,this)},i.multiplyMatrices=function(t,i){var e=t.elements,r=i.elements,n=this.elements,s=e[0],o=e[4],h=e[8],a=e[12],u=e[1],c=e[5],l=e[9],y=e[13],p=e[2],f=e[6],v=e[10],x=e[14],m=e[3],d=e[7],g=e[11],_=e[15],M=r[0],b=r[4],z=r[8],w=r[12],C=r[1],S=r[5],k=r[9],A=r[13],P=r[2],T=r[6],E=r[10],O=r[14],R=r[3],L=r[7],N=r[11],F=r[15];return n[0]=s*M+o*C+h*P+a*R,n[4]=s*b+o*S+h*T+a*L,n[8]=s*z+o*k+h*E+a*N,n[12]=s*w+o*A+h*O+a*F,n[1]=u*M+c*C+l*P+y*R,n[5]=u*b+c*S+l*T+y*L,n[9]=u*z+c*k+l*E+y*N,n[13]=u*w+c*A+l*O+y*F,n[2]=p*M+f*C+v*P+x*R,n[6]=p*b+f*S+v*T+x*L,n[10]=p*z+f*k+v*E+x*N,n[14]=p*w+f*A+v*O+x*F,n[3]=m*M+d*C+g*P+_*R,n[7]=m*b+d*S+g*T+_*L,n[11]=m*z+d*k+g*E+_*N,n[15]=m*w+d*A+g*O+_*F,this},i.multiplyScalar=function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},i.determinant=function(){var t=this.elements,i=t[0],e=t[4],r=t[8],n=t[12],s=t[1],o=t[5],h=t[9],a=t[13],u=t[2],c=t[6],l=t[10],y=t[14];return t[3]*(+n*h*c-r*a*c-n*o*l+e*a*l+r*o*y-e*h*y)+t[7]*(+i*h*y-i*a*l+n*s*l-r*s*y+r*a*u-n*h*u)+t[11]*(+i*a*c-i*o*y-n*s*c+e*s*y+n*o*u-e*a*u)+t[15]*(-r*o*u-i*h*c+i*o*l+r*s*c-e*s*l+e*h*u)},i.transpose=function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},i.setPosition=function(t,i,e){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=i,r[14]=e),this},i.getInverse=function(t,i){void 0!==i&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var e=this.elements,r=t.elements,n=r[0],s=r[1],o=r[2],h=r[3],a=r[4],u=r[5],c=r[6],l=r[7],y=r[8],p=r[9],f=r[10],v=r[11],x=r[12],m=r[13],d=r[14],g=r[15],_=p*d*l-m*f*l+m*c*v-u*d*v-p*c*g+u*f*g,M=x*f*l-y*d*l-x*c*v+a*d*v+y*c*g-a*f*g,b=y*m*l-x*p*l+x*u*v-a*m*v-y*u*g+a*p*g,z=x*p*c-y*m*c-x*u*f+a*m*f+y*u*d-a*p*d,w=n*_+s*M+o*b+h*z;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var C=1/w;return e[0]=_*C,e[1]=(m*f*h-p*d*h-m*o*v+s*d*v+p*o*g-s*f*g)*C,e[2]=(u*d*h-m*c*h+m*o*l-s*d*l-u*o*g+s*c*g)*C,e[3]=(p*c*h-u*f*h-p*o*l+s*f*l+u*o*v-s*c*v)*C,e[4]=M*C,e[5]=(y*d*h-x*f*h+x*o*v-n*d*v-y*o*g+n*f*g)*C,e[6]=(x*c*h-a*d*h-x*o*l+n*d*l+a*o*g-n*c*g)*C,e[7]=(a*f*h-y*c*h+y*o*l-n*f*l-a*o*v+n*c*v)*C,e[8]=b*C,e[9]=(x*p*h-y*m*h-x*s*v+n*m*v+y*s*g-n*p*g)*C,e[10]=(a*m*h-x*u*h+x*s*l-n*m*l-a*s*g+n*u*g)*C,e[11]=(y*u*h-a*p*h-y*s*l+n*p*l+a*s*v-n*u*v)*C,e[12]=z*C,e[13]=(y*m*o-x*p*o+x*s*f-n*m*f-y*s*d+n*p*d)*C,e[14]=(x*u*o-a*m*o-x*s*c+n*m*c+a*s*d-n*u*d)*C,e[15]=(a*p*o-y*u*o+y*s*c-n*p*c-a*s*f+n*u*f)*C,this},i.scale=function(t){var i=this.elements,e=t.x,r=t.y,n=t.z;return i[0]*=e,i[4]*=r,i[8]*=n,i[1]*=e,i[5]*=r,i[9]*=n,i[2]*=e,i[6]*=r,i[10]*=n,i[3]*=e,i[7]*=r,i[11]*=n,this},i.getMaxScaleOnAxis=function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],e=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,e,r))},i.makeTranslation=function(t,i,e){return this.set(1,0,0,t,0,1,0,i,0,0,1,e,0,0,0,1),this},i.makeRotationX=function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(1,0,0,0,0,i,-e,0,0,e,i,0,0,0,0,1),this},i.makeRotationY=function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(i,0,e,0,0,1,0,0,-e,0,i,0,0,0,0,1),this},i.makeRotationZ=function(t){var i=Math.cos(t),e=Math.sin(t);return this.set(i,-e,0,0,e,i,0,0,0,0,1,0,0,0,0,1),this},i.makeRotationAxis=function(t,i){var e=Math.cos(i),r=Math.sin(i),n=1-e,s=t.x,o=t.y,h=t.z,a=n*s,u=n*o;return this.set(a*s+e,a*o-r*h,a*h+r*o,0,a*o+r*h,u*o+e,u*h-r*s,0,a*h-r*o,u*h+r*s,n*h*h+e,0,0,0,0,1),this},i.makeScale=function(t,i,e){return this.set(t,0,0,0,0,i,0,0,0,0,e,0,0,0,0,1),this},i.makeShear=function(t,i,e){return this.set(1,i,e,0,t,1,e,0,t,i,1,0,0,0,0,1),this},i.compose=function(t,i,e){var r=this.elements,n=i._x,s=i._y,o=i._z,h=i._w,a=n+n,u=s+s,c=o+o,l=n*a,y=n*u,p=n*c,f=s*u,v=s*c,x=o*c,m=h*a,d=h*u,g=h*c,_=e.x,M=e.y,b=e.z;return r[0]=(1-(f+x))*_,r[1]=(y+g)*_,r[2]=(p-d)*_,r[3]=0,r[4]=(y-g)*M,r[5]=(1-(l+x))*M,r[6]=(v+m)*M,r[7]=0,r[8]=(p+d)*b,r[9]=(v-m)*b,r[10]=(1-(l+f))*b,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},i.decompose=function(t,i,e){var r=this.elements,n=f.set(r[0],r[1],r[2]).length(),s=f.set(r[4],r[5],r[6]).length(),o=f.set(r[8],r[9],r[10]).length();this.determinant()<0&&(n=-n),t.x=r[12],t.y=r[13],t.z=r[14],v.copy(this);var h=1/n,a=1/s,u=1/o;return v.elements[0]*=h,v.elements[1]*=h,v.elements[2]*=h,v.elements[4]*=a,v.elements[5]*=a,v.elements[6]*=a,v.elements[8]*=u,v.elements[9]*=u,v.elements[10]*=u,i.setFromRotationMatrix(v),e.x=n,e.y=s,e.z=o,this},i.makePerspective=function(t,i,e,r,n,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,h=2*n/(i-t),a=2*n/(e-r),u=(i+t)/(i-t),c=(e+r)/(e-r),l=-(s+n)/(s-n),y=-2*s*n/(s-n);return o[0]=h,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=a,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=l,o[14]=y,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},i.makeOrthographic=function(t,i,e,r,n,s){var o=this.elements,h=1/(i-t),a=1/(e-r),u=1/(s-n),c=(i+t)*h,l=(e+r)*a,y=(s+n)*u;return o[0]=2*h,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*a,o[9]=0,o[13]=-l,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-y,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},i.equals=function(t){for(var i=this.elements,e=t.elements,r=0;r<16;r++)if(i[r]!==e[r])return!1;return!0},i.fromArray=function(t,i){void 0===i&&(i=0);for(var e=0;e<16;e++)this.elements[e]=t[e+i];return this},i.toArray=function(t,i){void 0===t&&(t=[]),void 0===i&&(i=0);var e=this.elements;return t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3],t[i+4]=e[4],t[i+5]=e[5],t[i+6]=e[6],t[i+7]=e[7],t[i+8]=e[8],t[i+9]=e[9],t[i+10]=e[10],t[i+11]=e[11],t[i+12]=e[12],t[i+13]=e[13],t[i+14]=e[14],t[i+15]=e[15],t},t}(),f=new c,v=new p,x=new c(0,0,0),m=new c(1,1,1),d=new c,g=new c,_=new c,M=function(){function t(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var i=t.prototype;return i.set=function(t,i,e,r,n,s,o,h,a){var u=this.elements;return u[0]=t,u[1]=r,u[2]=o,u[3]=i,u[4]=n,u[5]=h,u[6]=e,u[7]=s,u[8]=a,this},i.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},i.clone=function(){return(new this.constructor).fromArray(this.elements)},i.copy=function(t){var i=this.elements,e=t.elements;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],this},i.extractBasis=function(t,i,e){return t.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),e.setFromMatrix3Column(this,2),this},i.setFromMatrix4=function(t){var i=t.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this},i.multiply=function(t){return this.multiplyMatrices(this,t)},i.premultiply=function(t){return this.multiplyMatrices(t,this)},i.multiplyMatrices=function(t,i){var e=t.elements,r=i.elements,n=this.elements,s=e[0],o=e[3],h=e[6],a=e[1],u=e[4],c=e[7],l=e[2],y=e[5],p=e[8],f=r[0],v=r[3],x=r[6],m=r[1],d=r[4],g=r[7],_=r[2],M=r[5],b=r[8];return n[0]=s*f+o*m+h*_,n[3]=s*v+o*d+h*M,n[6]=s*x+o*g+h*b,n[1]=a*f+u*m+c*_,n[4]=a*v+u*d+c*M,n[7]=a*x+u*g+c*b,n[2]=l*f+y*m+p*_,n[5]=l*v+y*d+p*M,n[8]=l*x+y*g+p*b,this},i.multiplyScalar=function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},i.determinant=function(){var t=this.elements,i=t[0],e=t[1],r=t[2],n=t[3],s=t[4],o=t[5],h=t[6],a=t[7],u=t[8];return i*s*u-i*o*a-e*n*u+e*o*h+r*n*a-r*s*h},i.getInverse=function(t,i){void 0!==i&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var e=t.elements,r=this.elements,n=e[0],s=e[1],o=e[2],h=e[3],a=e[4],u=e[5],c=e[6],l=e[7],y=e[8],p=y*a-u*l,f=u*c-y*h,v=l*h-a*c,x=n*p+s*f+o*v;if(0===x)return this.set(0,0,0,0,0,0,0,0,0);var m=1/x;return r[0]=p*m,r[1]=(o*l-y*s)*m,r[2]=(u*s-o*a)*m,r[3]=f*m,r[4]=(y*n-o*c)*m,r[5]=(o*h-u*n)*m,r[6]=v*m,r[7]=(s*c-l*n)*m,r[8]=(a*n-s*h)*m,this},i.transpose=function(){var t,i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this},i.getNormalMatrix=function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},i.transposeIntoArray=function(t){var i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this},i.setUvTransform=function(t,i,e,r,n,s,o){var h=Math.cos(n),a=Math.sin(n);this.set(e*h,e*a,-e*(h*s+a*o)+s+t,-r*a,r*h,-r*(-a*s+h*o)+o+i,0,0,1)},i.scale=function(t,i){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=i,e[4]*=i,e[7]*=i,this},i.rotate=function(t){var i=Math.cos(t),e=Math.sin(t),r=this.elements,n=r[0],s=r[3],o=r[6],h=r[1],a=r[4],u=r[7];return r[0]=i*n+e*h,r[3]=i*s+e*a,r[6]=i*o+e*u,r[1]=-e*n+i*h,r[4]=-e*s+i*a,r[7]=-e*o+i*u,this},i.translate=function(t,i){var e=this.elements;return e[0]+=t*e[2],e[3]+=t*e[5],e[6]+=t*e[8],e[1]+=i*e[2],e[4]+=i*e[5],e[7]+=i*e[8],this},i.equals=function(t){for(var i=this.elements,e=t.elements,r=0;r<9;r++)if(i[r]!==e[r])return!1;return!0},i.fromArray=function(t,i){void 0===i&&(i=0);for(var e=0;e<9;e++)this.elements[e]=t[e+i];return this},i.toArray=function(t,i){void 0===t&&(t=[]),void 0===i&&(i=0);var e=this.elements;return t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3],t[i+4]=e[4],t[i+5]=e[5],t[i+6]=e[6],t[i+7]=e[7],t[i+8]=e[8],t},t}(),b=function(){function t(i,e,r,n){void 0===i&&(i=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=t.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=i,this._y=e,this._z=r,this._order=n}var i=t.prototype;return i.set=function(t,i,e,r){return this._x=t,this._y=i,this._z=e,this._order=r||this._order,this._onChangeCallback(),this},i.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},i.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},i.setFromRotationMatrix=function(t,i,e){var r=n.clamp,s=t.elements,o=s[0],h=s[4],a=s[8],u=s[1],c=s[5],l=s[9],y=s[2],p=s[6],f=s[10];switch(i=i||this._order){case"XYZ":this._y=Math.asin(r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,f),this._z=Math.atan2(-h,o)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-y,o),this._z=0);break;case"ZXY":this._x=Math.asin(r(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-y,f),this._z=Math.atan2(-h,c)):(this._y=0,this._z=Math.atan2(u,o));break;case"ZYX":this._y=Math.asin(-r(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(p,f),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-h,c));break;case"YZX":this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-y,o)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-l,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!1!==e&&this._onChangeCallback(),this},i.setFromQuaternion=function(t,i,e){return z.makeRotationFromQuaternion(t),this.setFromRotationMatrix(z,i,e)},i.setFromVector3=function(t,i){return this.set(t.x,t.y,t.z,i||this._order)},i.reorder=function(t){return w.setFromEuler(this),this.setFromQuaternion(w,t)},i.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},i.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},i.toArray=function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t},i.toVector3=function(t){return t?t.set(this._x,this._y,this._z):new c(this._x,this._y,this._z)},i._onChange=function(t){return this._onChangeCallback=t,this},i._onChangeCallback=function(){},a(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}]),t}();b.DefaultOrder="XYZ",b.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var z=new p,w=new u,C=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=i}var i=t.prototype;return i.set=function(t,i){return this.x=t,this.y=i,this},i.setScalar=function(t){return this.x=t,this.y=t,this},i.setX=function(t){return this.x=t,this},i.setY=function(t){return this.y=t,this},i.setComponent=function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}return this},i.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},i.clone=function(){return new this.constructor(this.x,this.y)},i.copy=function(t){return this.x=t.x,this.y=t.y,this},i.add=function(t,i){return void 0!==i?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this)},i.addScalar=function(t){return this.x+=t,this.y+=t,this},i.addVectors=function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},i.addScaledVector=function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this},i.sub=function(t,i){return void 0!==i?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this)},i.subScalar=function(t){return this.x-=t,this.y-=t,this},i.subVectors=function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},i.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},i.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},i.divide=function(t){return this.x/=t.x,this.y/=t.y,this},i.divideScalar=function(t){return this.multiplyScalar(1/t)},i.applyMatrix3=function(t){var i=this.x,e=this.y,r=t.elements;return this.x=r[0]*i+r[3]*e+r[6],this.y=r[1]*i+r[4]*e+r[7],this},i.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},i.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},i.clamp=function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this},i.clampScalar=function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this},i.clampLength=function(t,i){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(i,e)))},i.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},i.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},i.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},i.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},i.negate=function(){return this.x=-this.x,this.y=-this.y,this},i.dot=function(t){return this.x*t.x+this.y*t.y},i.cross=function(t){return this.x*t.y-this.y*t.x},i.lengthSq=function(){return this.x*this.x+this.y*this.y},i.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},i.normalize=function(){return this.divideScalar(this.length()||1)},i.angle=function(){var t=Math.atan2(-this.y,-this.x)+Math.PI;return t},i.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},i.distanceToSquared=function(t){var i=this.x-t.x,e=this.y-t.y;return i*i+e*e},i.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},i.setLength=function(t){return this.normalize().multiplyScalar(t)},i.lerp=function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},i.lerpVectors=function(t,i,e){return this.x=t.x+(i.x-t.x)*e,this.y=t.y+(i.y-t.y)*e,this},i.equals=function(t){return t.x===this.x&&t.y===this.y},i.fromArray=function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this},i.toArray=function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t},i.fromBufferAttribute=function(t,i,e){return void 0!==e&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this},i.rotateAround=function(t,i){var e=Math.cos(i),r=Math.sin(i),n=this.x-t.x,s=this.y-t.y;return this.x=n*e-s*r+t.x,this.y=n*r+s*e+t.y,this},i.random=function(){return this.x=Math.random(),this.y=Math.random(),this},a(t,[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}}]),t}(),S={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},k={h:0,s:0,l:0},A={h:0,s:0,l:0};function P(t,i,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(i-t)*e:e<.5?i:e<2/3?t+6*(i-t)*(2/3-e):t}function T(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function E(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var O=function(){function t(t,i,e){return Object.defineProperty(this,"isColor",{value:!0}),void 0===i&&void 0===e?this.set(t):this.setRGB(t,i,e)}var i=t.prototype;return i.set=function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},i.setScalar=function(t){return this.r=t,this.g=t,this.b=t,this},i.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},i.setRGB=function(t,i,e){return this.r=t,this.g=i,this.b=e,this},i.setHSL=function(t,i,e){if(t=n.euclideanModulo(t,1),i=n.clamp(i,0,1),e=n.clamp(e,0,1),0===i)this.r=this.g=this.b=e;else{var r=e<=.5?e*(1+i):e+i-e*i,s=2*e-r;this.r=P(s,r,t+1/3),this.g=P(s,r,t),this.b=P(s,r,t-1/3)}return this},i.setStyle=function(t){function i(i){void 0!==i&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var e;if(e=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,n=e[1],s=e[2];switch(n){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,i(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,i(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s)){var o=parseFloat(r[1])/360,h=parseInt(r[2],10)/100,a=parseInt(r[3],10)/100;return i(r[5]),this.setHSL(o,h,a)}}}else if(e=/^\#([A-Fa-f0-9]+)$/.exec(t)){var u=e[1],c=u.length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},i.setColorName=function(t){var i=S[t];return void 0!==i?this.setHex(i):console.warn("THREE.Color: Unknown color "+t),this},i.clone=function(){return new this.constructor(this.r,this.g,this.b)},i.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},i.copyGammaToLinear=function(t,i){return void 0===i&&(i=2),this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},i.copyLinearToGamma=function(t,i){void 0===i&&(i=2);var e=i>0?1/i:1;return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},i.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},i.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},i.copySRGBToLinear=function(t){return this.r=T(t.r),this.g=T(t.g),this.b=T(t.b),this},i.copyLinearToSRGB=function(t){return this.r=E(t.r),this.g=E(t.g),this.b=E(t.b),this},i.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},i.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},i.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},i.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},i.getHSL=function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var i,e,r=this.r,n=this.g,s=this.b,o=Math.max(r,n,s),h=Math.min(r,n,s),a=(h+o)/2;if(h===o)i=0,e=0;else{var u=o-h;switch(e=a<=.5?u/(o+h):u/(2-o-h),o){case r:i=(n-s)/u+(n<s?6:0);break;case n:i=(s-r)/u+2;break;case s:i=(r-n)/u+4}i/=6}return t.h=i,t.s=e,t.l=a,t},i.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},i.offsetHSL=function(t,i,e){return this.getHSL(k),k.h+=t,k.s+=i,k.l+=e,this.setHSL(k.h,k.s,k.l),this},i.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},i.addColors=function(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this},i.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},i.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},i.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},i.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},i.lerp=function(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this},i.lerpHSL=function(t,i){this.getHSL(k),t.getHSL(A);var e=n.lerp(k.h,A.h,i),r=n.lerp(k.s,A.s,i),s=n.lerp(k.l,A.l,i);return this.setHSL(e,r,s),this},i.equals=function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},i.fromArray=function(t,i){return void 0===i&&(i=0),this.r=t[i],this.g=t[i+1],this.b=t[i+2],this},i.toArray=function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t},i.fromBufferAttribute=function(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},i.toJSON=function(){return this.getHex()},t}();function R(){this.type="Curve",this.arcLengthDivisions=200}function L(t,i,e,r,n,s,o,h){R.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=i||0,this.xRadius=e||1,this.yRadius=r||1,this.aStartAngle=n||0,this.aEndAngle=s||2*Math.PI,this.aClockwise=o||!1,this.aRotation=h||0}function N(t,i,e,r,n,s){L.call(this,t,i,e,e,r,n,s),this.type="ArcCurve"}function F(){var t=0,i=0,e=0,r=0;function n(n,s,o,h){t=n,i=o,e=-3*n+3*s-2*o-h,r=2*n-2*s+o+h}return{initCatmullRom:function(t,i,e,r,s){n(i,e,s*(e-t),s*(r-i))},initNonuniformCatmullRom:function(t,i,e,r,s,o,h){var a=(i-t)/s-(e-t)/(s+o)+(e-i)/o,u=(e-i)/o-(r-i)/(o+h)+(r-e)/h;n(i,e,a*=o,u*=o)},calc:function(n){var s=n*n;return t+i*n+e*s+r*(s*n)}}}O.NAMES=S,O.prototype.r=1,O.prototype.g=1,O.prototype.b=1,Object.assign(R.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,i){var e=this.getUtoTmapping(t);return this.getPoint(e,i)},getPoints:function(t){void 0===t&&(t=5);for(var i=[],e=0;e<=t;e++)i.push(this.getPoint(e/t));return i},getSpacedPoints:function(t){void 0===t&&(t=5);for(var i=[],e=0;e<=t;e++)i.push(this.getPointAt(e/t));return i},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i,e=[],r=this.getPoint(0),n=0;e.push(0);for(var s=1;s<=t;s++)n+=(i=this.getPoint(s/t)).distanceTo(r),e.push(n),r=i;return this.cacheArcLengths=e,e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,i){var e,r=this.getLengths(),n=0,s=r.length;e=i||t*r[s-1];for(var o,h=0,a=s-1;h<=a;)if((o=r[n=Math.floor(h+(a-h)/2)]-e)<0)h=n+1;else{if(!(o>0)){a=n;break}a=n-1}if(r[n=a]===e)return n/(s-1);var u=r[n];return(n+(e-u)/(r[n+1]-u))/(s-1)},getTangent:function(t,i){var e=1e-4,r=t-e,n=t+e;r<0&&(r=0),n>1&&(n=1);var s=this.getPoint(r),o=this.getPoint(n),h=i||(s.isVector2?new C:new c);return h.copy(o).sub(s).normalize(),h},getTangentAt:function(t,i){var e=this.getUtoTmapping(t);return this.getTangent(e,i)},computeFrenetFrames:function(t,i){for(var e=new c,r=[],s=[],o=[],h=new c,a=new p,u=0;u<=t;u++){var l=u/t;r[u]=this.getTangentAt(l,new c),r[u].normalize()}s[0]=new c,o[0]=new c;var y=Number.MAX_VALUE,f=Math.abs(r[0].x),v=Math.abs(r[0].y),x=Math.abs(r[0].z);f<=y&&(y=f,e.set(1,0,0)),v<=y&&(y=v,e.set(0,1,0)),x<=y&&e.set(0,0,1),h.crossVectors(r[0],e).normalize(),s[0].crossVectors(r[0],h),o[0].crossVectors(r[0],s[0]);for(var m=1;m<=t;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),h.crossVectors(r[m-1],r[m]),h.length()>Number.EPSILON){h.normalize();var d=Math.acos(n.clamp(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(a.makeRotationAxis(h,d))}o[m].crossVectors(r[m],s[m])}if(!0===i){var g=Math.acos(n.clamp(s[0].dot(s[t]),-1,1));g/=t,r[0].dot(h.crossVectors(s[0],s[t]))>0&&(g=-g);for(var _=1;_<=t;_++)s[_].applyMatrix4(a.makeRotationAxis(r[_],g*_)),o[_].crossVectors(r[_],s[_])}return{tangents:r,normals:s,binormals:o}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),L.prototype=Object.create(R.prototype),L.prototype.constructor=L,L.prototype.isEllipseCurve=!0,L.prototype.getPoint=function(t,i){for(var e=i||new C,r=2*Math.PI,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(n=s?0:r),!0!==this.aClockwise||s||(n===r?n=-r:n-=r);var o=this.aStartAngle+t*n,h=this.aX+this.xRadius*Math.cos(o),a=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),l=h-this.aX,y=a-this.aY;h=l*u-y*c+this.aX,a=l*c+y*u+this.aY}return e.set(h,a)},L.prototype.copy=function(t){return R.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},L.prototype.toJSON=function(){var t=R.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},L.prototype.fromJSON=function(t){return R.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},N.prototype=Object.create(L.prototype),N.prototype.constructor=N,N.prototype.isArcCurve=!0;var Z=new c,V=new F,q=new F,J=new F;function X(t,i,e,r){R.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=i||!1,this.curveType=e||"centripetal",this.tension=void 0!==r?r:.5}function Y(t,i,e,r,n){var s=.5*(r-i),o=.5*(n-e),h=t*t;return(2*e-2*r+s+o)*(t*h)+(-3*e+3*r-2*s-o)*h+s*t+e}function H(t,i,e,r){return function(t,i){var e=1-t;return e*e*i}(t,i)+function(t,i){return 2*(1-t)*t*i}(t,e)+function(t,i){return t*t*i}(t,r)}function j(t,i,e,r,n){return function(t,i){var e=1-t;return e*e*e*i}(t,i)+function(t,i){var e=1-t;return 3*e*e*t*i}(t,e)+function(t,i){return 3*(1-t)*t*t*i}(t,r)+function(t,i){return t*t*t*i}(t,n)}function I(t,i,e,r){R.call(this),this.type="CubicBezierCurve",this.v0=t||new C,this.v1=i||new C,this.v2=e||new C,this.v3=r||new C}function B(t,i,e,r){R.call(this),this.type="CubicBezierCurve3",this.v0=t||new c,this.v1=i||new c,this.v2=e||new c,this.v3=r||new c}function Q(t,i){R.call(this),this.type="LineCurve",this.v1=t||new C,this.v2=i||new C}function U(t,i){R.call(this),this.type="LineCurve3",this.v1=t||new c,this.v2=i||new c}function D(t,i,e){R.call(this),this.type="QuadraticBezierCurve",this.v0=t||new C,this.v1=i||new C,this.v2=e||new C}function G(t,i,e){R.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new c,this.v1=i||new c,this.v2=e||new c}function W(t){R.call(this),this.type="SplineCurve",this.points=t||[]}X.prototype=Object.create(R.prototype),X.prototype.constructor=X,X.prototype.isCatmullRomCurve3=!0,X.prototype.getPoint=function(t,i){var e,r,n=i||new c,s=this.points,o=s.length,h=(o-(this.closed?0:1))*t,a=Math.floor(h),u=h-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/o)+1)*o:0===u&&a===o-1&&(a=o-2,u=1),this.closed||a>0?e=s[(a-1)%o]:(Z.subVectors(s[0],s[1]).add(s[0]),e=Z);var l=s[a%o],y=s[(a+1)%o];if(this.closed||a+2<o?r=s[(a+2)%o]:(Z.subVectors(s[o-1],s[o-2]).add(s[o-1]),r=Z),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,f=Math.pow(e.distanceToSquared(l),p),v=Math.pow(l.distanceToSquared(y),p),x=Math.pow(y.distanceToSquared(r),p);v<1e-4&&(v=1),f<1e-4&&(f=v),x<1e-4&&(x=v),V.initNonuniformCatmullRom(e.x,l.x,y.x,r.x,f,v,x),q.initNonuniformCatmullRom(e.y,l.y,y.y,r.y,f,v,x),J.initNonuniformCatmullRom(e.z,l.z,y.z,r.z,f,v,x)}else"catmullrom"===this.curveType&&(V.initCatmullRom(e.x,l.x,y.x,r.x,this.tension),q.initCatmullRom(e.y,l.y,y.y,r.y,this.tension),J.initCatmullRom(e.z,l.z,y.z,r.z,this.tension));return n.set(V.calc(u),q.calc(u),J.calc(u)),n},X.prototype.copy=function(t){R.prototype.copy.call(this,t),this.points=[];for(var i=0,e=t.points.length;i<e;i++){var r=t.points[i];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},X.prototype.toJSON=function(){var t=R.prototype.toJSON.call(this);t.points=[];for(var i=0,e=this.points.length;i<e;i++){var r=this.points[i];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},X.prototype.fromJSON=function(t){R.prototype.fromJSON.call(this,t),this.points=[];for(var i=0,e=t.points.length;i<e;i++){var r=t.points[i];this.points.push((new c).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},I.prototype=Object.create(R.prototype),I.prototype.constructor=I,I.prototype.isCubicBezierCurve=!0,I.prototype.getPoint=function(t,i){var e=i||new C,r=this.v0,n=this.v1,s=this.v2,o=this.v3;return e.set(j(t,r.x,n.x,s.x,o.x),j(t,r.y,n.y,s.y,o.y)),e},I.prototype.copy=function(t){return R.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},I.prototype.toJSON=function(){var t=R.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},I.prototype.fromJSON=function(t){return R.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},B.prototype=Object.create(R.prototype),B.prototype.constructor=B,B.prototype.isCubicBezierCurve3=!0,B.prototype.getPoint=function(t,i){var e=i||new c,r=this.v0,n=this.v1,s=this.v2,o=this.v3;return e.set(j(t,r.x,n.x,s.x,o.x),j(t,r.y,n.y,s.y,o.y),j(t,r.z,n.z,s.z,o.z)),e},B.prototype.copy=function(t){return R.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},B.prototype.toJSON=function(){var t=R.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},B.prototype.fromJSON=function(t){return R.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Q.prototype=Object.create(R.prototype),Q.prototype.constructor=Q,Q.prototype.isLineCurve=!0,Q.prototype.getPoint=function(t,i){var e=i||new C;return 1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},Q.prototype.getPointAt=function(t,i){return this.getPoint(t,i)},Q.prototype.getTangent=function(t,i){var e=i||new C;return e.copy(this.v2).sub(this.v1).normalize(),e},Q.prototype.copy=function(t){return R.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Q.prototype.toJSON=function(){var t=R.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Q.prototype.fromJSON=function(t){return R.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},U.prototype=Object.create(R.prototype),U.prototype.constructor=U,U.prototype.isLineCurve3=!0,U.prototype.getPoint=function(t,i){var e=i||new c;return 1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},U.prototype.getPointAt=function(t,i){return this.getPoint(t,i)},U.prototype.copy=function(t){return R.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},U.prototype.toJSON=function(){var t=R.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},U.prototype.fromJSON=function(t){return R.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},D.prototype=Object.create(R.prototype),D.prototype.constructor=D,D.prototype.isQuadraticBezierCurve=!0,D.prototype.getPoint=function(t,i){var e=i||new C,r=this.v0,n=this.v1,s=this.v2;return e.set(H(t,r.x,n.x,s.x),H(t,r.y,n.y,s.y)),e},D.prototype.copy=function(t){return R.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},D.prototype.toJSON=function(){var t=R.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},D.prototype.fromJSON=function(t){return R.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},G.prototype=Object.create(R.prototype),G.prototype.constructor=G,G.prototype.isQuadraticBezierCurve3=!0,G.prototype.getPoint=function(t,i){var e=i||new c,r=this.v0,n=this.v1,s=this.v2;return e.set(H(t,r.x,n.x,s.x),H(t,r.y,n.y,s.y),H(t,r.z,n.z,s.z)),e},G.prototype.copy=function(t){return R.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},G.prototype.toJSON=function(){var t=R.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},G.prototype.fromJSON=function(t){return R.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},W.prototype=Object.create(R.prototype),W.prototype.constructor=W,W.prototype.isSplineCurve=!0,W.prototype.getPoint=function(t,i){var e=i||new C,r=this.points,n=(r.length-1)*t,s=Math.floor(n),o=n-s,h=r[0===s?s:s-1],a=r[s],u=r[s>r.length-2?r.length-1:s+1],c=r[s>r.length-3?r.length-1:s+2];return e.set(Y(o,h.x,a.x,u.x,c.x),Y(o,h.y,a.y,u.y,c.y)),e},W.prototype.copy=function(t){R.prototype.copy.call(this,t),this.points=[];for(var i=0,e=t.points.length;i<e;i++){var r=t.points[i];this.points.push(r.clone())}return this},W.prototype.toJSON=function(){var t=R.prototype.toJSON.call(this);t.points=[];for(var i=0,e=this.points.length;i<e;i++){var r=this.points[i];t.points.push(r.toArray())}return t},W.prototype.fromJSON=function(t){R.prototype.fromJSON.call(this,t),this.points=[];for(var i=0,e=t.points.length;i<e;i++){var r=t.points[i];this.points.push((new C).fromArray(r))}return this};var $=Object.freeze({__proto__:null,ArcCurve:N,CatmullRomCurve3:X,CubicBezierCurve:I,CubicBezierCurve3:B,EllipseCurve:L,LineCurve:Q,LineCurve3:U,QuadraticBezierCurve:D,QuadraticBezierCurve3:G,SplineCurve:W});function K(){R.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function tt(t){K.call(this),this.type="Path",this.currentPoint=new C,t&&this.setFromPoints(t)}function it(t){tt.call(this,t),this.uuid=n.generateUUID(),this.type="Shape",this.holes=[]}K.prototype=Object.assign(Object.create(R.prototype),{constructor:K,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);t.equals(i)||this.curves.push(new Q(i,t))},getPoint:function(t){for(var i=t*this.getLength(),e=this.getCurveLengths(),r=0;r<e.length;){if(e[r]>=i){var n=e[r]-i,s=this.curves[r],o=s.getLength(),h=0===o?0:1-n/o;return s.getPointAt(h)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],i=0,e=0,r=this.curves.length;e<r;e++)i+=this.curves[e].getLength(),t.push(i);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var i=[],e=0;e<=t;e++)i.push(this.getPoint(e/t));return this.autoClose&&i.push(i[0]),i},getPoints:function(t){t=t||12;for(var i,e=[],r=0,n=this.curves;r<n.length;r++)for(var s=n[r],o=s&&s.isEllipseCurve?2*t:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t,h=s.getPoints(o),a=0;a<h.length;a++){var u=h[a];i&&i.equals(u)||(e.push(u),i=u)}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e},copy:function(t){R.prototype.copy.call(this,t),this.curves=[];for(var i=0,e=t.curves.length;i<e;i++){var r=t.curves[i];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=R.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var i=0,e=this.curves.length;i<e;i++){var r=this.curves[i];t.curves.push(r.toJSON())}return t},fromJSON:function(t){R.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var i=0,e=t.curves.length;i<e;i++){var r=t.curves[i];this.curves.push((new $[r.type]).fromJSON(r))}return this}}),tt.prototype=Object.assign(Object.create(K.prototype),{constructor:tt,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var i=1,e=t.length;i<e;i++)this.lineTo(t[i].x,t[i].y);return this},moveTo:function(t,i){return this.currentPoint.set(t,i),this},lineTo:function(t,i){var e=new Q(this.currentPoint.clone(),new C(t,i));return this.curves.push(e),this.currentPoint.set(t,i),this},quadraticCurveTo:function(t,i,e,r){var n=new D(this.currentPoint.clone(),new C(t,i),new C(e,r));return this.curves.push(n),this.currentPoint.set(e,r),this},bezierCurveTo:function(t,i,e,r,n,s){var o=new I(this.currentPoint.clone(),new C(t,i),new C(e,r),new C(n,s));return this.curves.push(o),this.currentPoint.set(n,s),this},splineThru:function(t){var i=new W([this.currentPoint.clone()].concat(t));return this.curves.push(i),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,i,e,r,n,s){var o=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(t+o,i+h,e,r,n,s),this},absarc:function(t,i,e,r,n,s){return this.absellipse(t,i,e,e,r,n,s),this},ellipse:function(t,i,e,r,n,s,o,h){var a=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+a,i+u,e,r,n,s,o,h),this},absellipse:function(t,i,e,r,n,s,o,h){var a=new L(t,i,e,r,n,s,o,h);if(this.curves.length>0){var u=a.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(a);var c=a.getPoint(1);return this.currentPoint.copy(c),this},copy:function(t){return K.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=K.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return K.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),it.prototype=Object.assign(Object.create(tt.prototype),{constructor:it,getPointsHoles:function(t){for(var i=[],e=0,r=this.holes.length;e<r;e++)i[e]=this.holes[e].getPoints(t);return i},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){tt.prototype.copy.call(this,t),this.holes=[];for(var i=0,e=t.holes.length;i<e;i++){var r=t.holes[i];this.holes.push(r.clone())}return this},toJSON:function(){var t=tt.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var i=0,e=this.holes.length;i<e;i++){var r=this.holes[i];t.holes.push(r.toJSON())}return t},fromJSON:function(t){tt.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var i=0,e=t.holes.length;i<e;i++){var r=t.holes[i];this.holes.push((new tt).fromJSON(r))}return this}});var et=function(t,i,e){e=e||2;var r,n,s,o,h,a,u,c=i&&i.length,l=c?i[0]*e:t.length,y=rt(t,0,l,e,!0),p=[];if(!y||y.next===y.prev)return p;if(c&&(y=function(t,i,e,r){var n,s,o,h=[];for(n=0,s=i.length;n<s;n++)(o=rt(t,i[n]*r,n<s-1?i[n+1]*r:t.length,r,!1))===o.next&&(o.steiner=!0),h.push(ft(o));for(h.sort(ct),n=0;n<h.length;n++)lt(h[n],e),e=nt(e,e.next);return e}(t,i,y,e)),t.length>80*e){r=s=t[0],n=o=t[1];for(var f=e;f<l;f+=e)(h=t[f])<r&&(r=h),(a=t[f+1])<n&&(n=a),h>s&&(s=h),a>o&&(o=a);u=0!==(u=Math.max(s-r,o-n))?1/u:0}return st(y,p,e,r,n,u),p};function rt(t,i,e,r,n){var s,o;if(n===function(t,i,e,r){for(var n=0,s=i,o=e-r;s<e;s+=r)n+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return n}(t,i,e,r)>0)for(s=i;s<e;s+=r)o=wt(s,t[s],t[s+1],o);else for(s=e-r;s>=i;s-=r)o=wt(s,t[s],t[s+1],o);return o&&dt(o,o.next)&&(Ct(o),o=o.next),o}function nt(t,i){if(!t)return t;i||(i=t);var e,r=t;do{if(e=!1,r.steiner||!dt(r,r.next)&&0!==mt(r.prev,r,r.next))r=r.next;else{if(Ct(r),(r=i=r.prev)===r.next)break;e=!0}}while(e||r!==i);return i}function st(t,i,e,r,n,s,o){if(t){!o&&s&&function(t,i,e,r){var n=t;do{null===n.z&&(n.z=pt(n.x,n.y,i,e,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var i,e,r,n,s,o,h,a,u=1;do{for(e=t,t=null,s=null,o=0;e;){for(o++,r=e,h=0,i=0;i<u&&(h++,r=r.nextZ);i++);for(a=u;h>0||a>0&&r;)0!==h&&(0===a||!r||e.z<=r.z)?(n=e,e=e.nextZ,h--):(n=r,r=r.nextZ,a--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;e=r}s.nextZ=null,u*=2}while(o>1)}(n)}(t,r,n,s);for(var h,a,u=t;t.prev!==t.next;)if(h=t.prev,a=t.next,s?ht(t,r,n,s):ot(t))i.push(h.i/e),i.push(t.i/e),i.push(a.i/e),Ct(t),t=a.next,u=a.next;else if((t=a)===u){o?1===o?st(t=at(nt(t),i,e),i,e,r,n,s,2):2===o&&ut(t,i,e,r,n,s):st(nt(t),i,e,r,n,s,1);break}}}function ot(t){var i=t.prev,e=t,r=t.next;if(mt(i,e,r)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(vt(i.x,i.y,e.x,e.y,r.x,r.y,n.x,n.y)&&mt(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function ht(t,i,e,r){var n=t.prev,s=t,o=t.next;if(mt(n,s,o)>=0)return!1;for(var h=n.x<s.x?n.x<o.x?n.x:o.x:s.x<o.x?s.x:o.x,a=n.y<s.y?n.y<o.y?n.y:o.y:s.y<o.y?s.y:o.y,u=n.x>s.x?n.x>o.x?n.x:o.x:s.x>o.x?s.x:o.x,c=n.y>s.y?n.y>o.y?n.y:o.y:s.y>o.y?s.y:o.y,l=pt(h,a,i,e,r),y=pt(u,c,i,e,r),p=t.prevZ,f=t.nextZ;p&&p.z>=l&&f&&f.z<=y;){if(p!==t.prev&&p!==t.next&&vt(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&mt(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&vt(n.x,n.y,s.x,s.y,o.x,o.y,f.x,f.y)&&mt(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=l;){if(p!==t.prev&&p!==t.next&&vt(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&mt(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=y;){if(f!==t.prev&&f!==t.next&&vt(n.x,n.y,s.x,s.y,o.x,o.y,f.x,f.y)&&mt(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function at(t,i,e){var r=t;do{var n=r.prev,s=r.next.next;!dt(n,s)&&gt(n,r,r.next,s)&&bt(n,s)&&bt(s,n)&&(i.push(n.i/e),i.push(r.i/e),i.push(s.i/e),Ct(r),Ct(r.next),r=t=s),r=r.next}while(r!==t);return nt(r)}function ut(t,i,e,r,n,s){var o=t;do{for(var h=o.next.next;h!==o.prev;){if(o.i!==h.i&&xt(o,h)){var a=zt(o,h);return o=nt(o,o.next),a=nt(a,a.next),st(o,i,e,r,n,s),void st(a,i,e,r,n,s)}h=h.next}o=o.next}while(o!==t)}function ct(t,i){return t.x-i.x}function lt(t,i){if(i=function(t,i){var e,r=i,n=t.x,s=t.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var h=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(h<=n&&h>o){if(o=h,h===n){if(s===r.y)return r;if(s===r.next.y)return r.next}e=r.x<r.next.x?r:r.next}}r=r.next}while(r!==i);if(!e)return null;if(n===o)return e;var a,u=e,c=e.x,l=e.y,y=1/0;r=e;do{n>=r.x&&r.x>=c&&n!==r.x&&vt(s<l?n:o,s,c,l,s<l?o:n,s,r.x,r.y)&&(a=Math.abs(s-r.y)/(n-r.x),bt(r,t)&&(a<y||a===y&&(r.x>e.x||r.x===e.x&&yt(e,r)))&&(e=r,y=a)),r=r.next}while(r!==u);return e}(t,i)){var e=zt(i,t);nt(i,i.next),nt(e,e.next)}}function yt(t,i){return mt(t.prev,t,i.prev)<0&&mt(i.next,t,t.next)<0}function pt(t,i,e,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-e)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-r)*n)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function ft(t){var i=t,e=t;do{(i.x<e.x||i.x===e.x&&i.y<e.y)&&(e=i),i=i.next}while(i!==t);return e}function vt(t,i,e,r,n,s,o,h){return(n-o)*(i-h)-(t-o)*(s-h)>=0&&(t-o)*(r-h)-(e-o)*(i-h)>=0&&(e-o)*(s-h)-(n-o)*(r-h)>=0}function xt(t,i){return t.next.i!==i.i&&t.prev.i!==i.i&&!function(t,i){var e=t;do{if(e.i!==t.i&&e.next.i!==t.i&&e.i!==i.i&&e.next.i!==i.i&&gt(e,e.next,t,i))return!0;e=e.next}while(e!==t);return!1}(t,i)&&(bt(t,i)&&bt(i,t)&&function(t,i){var e=t,r=!1,n=(t.x+i.x)/2,s=(t.y+i.y)/2;do{e.y>s!=e.next.y>s&&e.next.y!==e.y&&n<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next}while(e!==t);return r}(t,i)&&(mt(t.prev,t,i.prev)||mt(t,i.prev,i))||dt(t,i)&&mt(t.prev,t,t.next)>0&&mt(i.prev,i,i.next)>0)}function mt(t,i,e){return(i.y-t.y)*(e.x-i.x)-(i.x-t.x)*(e.y-i.y)}function dt(t,i){return t.x===i.x&&t.y===i.y}function gt(t,i,e,r){var n=Mt(mt(t,i,e)),s=Mt(mt(t,i,r)),o=Mt(mt(e,r,t)),h=Mt(mt(e,r,i));return n!==s&&o!==h||(!(0!==n||!_t(t,e,i))||(!(0!==s||!_t(t,r,i))||(!(0!==o||!_t(e,t,r))||!(0!==h||!_t(e,i,r)))))}function _t(t,i,e){return i.x<=Math.max(t.x,e.x)&&i.x>=Math.min(t.x,e.x)&&i.y<=Math.max(t.y,e.y)&&i.y>=Math.min(t.y,e.y)}function Mt(t){return t>0?1:t<0?-1:0}function bt(t,i){return mt(t.prev,t,t.next)<0?mt(t,i,t.next)>=0&&mt(t,t.prev,i)>=0:mt(t,i,t.prev)<0||mt(t,t.next,i)<0}function zt(t,i){var e=new St(t.i,t.x,t.y),r=new St(i.i,i.x,i.y),n=t.next,s=i.prev;return t.next=i,i.prev=t,e.next=n,n.prev=e,r.next=e,e.prev=r,s.next=r,r.prev=s,r}function wt(t,i,e,r){var n=new St(t,i,e);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Ct(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function St(t,i,e){this.i=t,this.x=i,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var kt={area:function(t){for(var i=t.length,e=0,r=i-1,n=0;n<i;r=n++)e+=t[r].x*t[n].y-t[n].x*t[r].y;return.5*e},isClockWise:function(t){return kt.area(t)<0},triangulateShape:function(t,i){var e=[],r=[],n=[];At(t),Pt(e,t);var s=t.length;i.forEach(At);for(var o=0;o<i.length;o++)r.push(s),s+=i[o].length,Pt(e,i[o]);for(var h=et(e,r),a=0;a<h.length;a+=3)n.push(h.slice(a,a+3));return n}};function At(t){var i=t.length;i>2&&t[i-1].equals(t[0])&&t.pop()}function Pt(t,i){for(var e=0;e<i.length;e++)t.push(i[e].x),t.push(i[e].y)}function Tt(){this.type="ShapePath",this.color=new O,this.subPaths=[],this.currentPath=null}function Et(t){this.type="Font",this.data=t}function Ot(t,i,e,r,n){var s=n.glyphs[t]||n.glyphs["?"];if(s){var o,h,a,u,c,l,y,p,f=new Tt;if(s.o)for(var v=s._cachedOutline||(s._cachedOutline=s.o.split(" ")),x=0,m=v.length;x<m;){switch(v[x++]){case"m":o=v[x++]*i+e,h=v[x++]*i+r,f.moveTo(o,h);break;case"l":o=v[x++]*i+e,h=v[x++]*i+r,f.lineTo(o,h);break;case"q":a=v[x++]*i+e,u=v[x++]*i+r,c=v[x++]*i+e,l=v[x++]*i+r,f.quadraticCurveTo(c,l,a,u);break;case"b":a=v[x++]*i+e,u=v[x++]*i+r,c=v[x++]*i+e,l=v[x++]*i+r,y=v[x++]*i+e,p=v[x++]*i+r,f.bezierCurveTo(c,l,y,p,a,u)}}return{offsetX:s.ha*i,path:f}}console.error('THREE.Font: character "'+t+'" does not exists in font family '+n.familyName+".")}Object.assign(Tt.prototype,{moveTo:function(t,i){return this.currentPath=new tt,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,i),this},lineTo:function(t,i){return this.currentPath.lineTo(t,i),this},quadraticCurveTo:function(t,i,e,r){return this.currentPath.quadraticCurveTo(t,i,e,r),this},bezierCurveTo:function(t,i,e,r,n,s){return this.currentPath.bezierCurveTo(t,i,e,r,n,s),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,i){function e(t){for(var i=[],e=0,r=t.length;e<r;e++){var n=t[e],s=new it;s.curves=n.curves,i.push(s)}return i}function r(t,i){for(var e=i.length,r=!1,n=e-1,s=0;s<e;n=s++){var o=i[n],h=i[s],a=h.x-o.x,u=h.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=i[s],a=-a,h=i[n],u=-u),t.y<o.y||t.y>h.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var c=u*(t.x-o.x)-a*(t.y-o.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(t.y!==o.y)continue;if(h.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=h.x)return!0}}return r}var n,s,o,h=kt.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===i)return e(a);var u=[];if(1===a.length)return s=a[0],(o=new it).curves=s.curves,u.push(o),u;var c=!h(a[0].getPoints());c=t?!c:c;var l,y,p=[],f=[],v=[],x=0;f[x]=void 0,v[x]=[];for(var m=0,d=a.length;m<d;m++)n=h(l=(s=a[m]).getPoints()),(n=t?!n:n)?(!c&&f[x]&&x++,f[x]={s:new it,p:l},f[x].s.curves=s.curves,c&&x++,v[x]=[]):v[x].push({h:s,p:l[0]});if(!f[0])return e(a);if(f.length>1){for(var g=!1,_=[],M=0,b=f.length;M<b;M++)p[M]=[];for(var z=0,w=f.length;z<w;z++)for(var C=v[z],S=0;S<C.length;S++){for(var k=C[S],A=!0,P=0;P<f.length;P++)r(k.p,f[P].p)&&(z!==P&&_.push({froms:z,tos:P,hole:S}),A?(A=!1,p[P].push(k)):g=!0);A&&p[z].push(k)}_.length>0&&(g||(v=p))}for(var T=0,E=f.length;T<E;T++){o=f[T].s,u.push(o);for(var O=0,R=(y=v[T]).length;O<R;O++)o.holes.push(y[O].h)}return u}}),Object.assign(Et.prototype,{isFont:!0,generateShapes:function(t,i){void 0===i&&(i=100);for(var e=[],r=function(t,i,e){for(var r=Array.from?Array.from(t):String(t).split(""),n=i/e.resolution,s=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*n,o=[],h=0,a=0,u=0;u<r.length;u++){var c=r[u];if("\n"===c)h=0,a-=s;else{var l=Ot(c,n,h,a,e);h+=l.offsetX,o.push(l.path)}}return o}(t,i,this.data),n=0,s=r.length;n<s;n++)Array.prototype.push.apply(e,r[n].toShapes());return e}}),t.ArcCurve=N,t.CatmullRomCurve3=X,t.Color=O,t.CubicBezierCurve=I,t.CubicBezierCurve3=B,t.Curve=R,t.CurvePath=K,t.Cylindrical=o,t.EllipseCurve=L,t.Euler=b,t.Font=Et,t.LineCurve=Q,t.LineCurve3=U,t.Matrix3=M,t.Matrix4=p,t.Path=tt,t.QuadraticBezierCurve=D,t.QuadraticBezierCurve3=G,t.Quaternion=u,t.Shape=it,t.ShapePath=Tt,t.ShapeUtils=kt,t.Spherical=s,t.SplineCurve=W,t.Vector2=C,t.Vector3=c,Object.defineProperty(t,"__esModule",{value:!0})}));
